<div class="container mx-auto px-4 py-8">
  <div class="flex justify-between items-center">
    <h1 class="text-4xl font-bold">Welcome, <%= @user.first_name || @user.username %>!</h1>
    <%= button_to "Sign Out", logout_path, method: :delete, class: "bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-md" %>
  </div>
  <section class="mt-8">
    <h2 class="text-2xl font-semibold">My Library</h2>
    <% watchlists = @user.watchlists.includes(:movie) %>
    <% if watchlists.any? %>
      <%= turbo_frame_tag "library-list" do %>
        <div class="mt-4 grid gap-4 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4">
          <% watchlists.each do |wl| %>
            <%= turbo_frame_tag "watchlist-item-#{wl.id}" do %>
              <% m = wl.movie %>
              <div class="rounded-2xl border border-neutral-100 bg-white p-4 shadow-sm">
                <div class="flex items-start gap-3">
                  <%= image_tag m.poster_url.presence || "https://placehold.co/150x225?text=No+Image", alt: m.title, class: "h-24 w-16 rounded-md object-cover" %>
                  <div class="flex-1">
                    <h3 class="font-semibold"><%= m.title %></h3>
                    <p class="text-sm text-slate-600">Status: <%= wl.status.humanize %></p>
                  </div>
                  <div class="text-right">
                    <%= button_to "Remove", watchlist_path(wl), method: :delete, data: { turbo_frame: "watchlist-item-#{wl.id}" }, class: "inline-flex items-center rounded-md border border-neutral-200 bg-white px-3 py-2 text-sm text-slate-700 hover:bg-neutral-50" %>
                  </div>
                </div>
              </div>
            <% end %>
          <% end %>
        </div>
      <% end %>
    <% else %>
      <p class="mt-2 text-slate-600">Your library is empty. Add movies from the search results.</p>
    <% end %>
  </section>
</div>
